#standardSQL
SELECT *
FROM ML.PREDICT(MODEL `eveonegcp.sample_model13_real_estate`, -- Changed to your real estate model
  (
    SELECT
      `ID` AS `id`,
      `都道府県名` AS `prefecture_name`,
      `市区町村名` AS `city_name`,
      `地区名` AS `district_name`,
      `最寄駅_名称` AS `nearest_station_name`,
      CAST(`最寄駅_距離_分_` AS FLOAT64) AS `distance_to_station_minutes`,
      `間取り` AS `layout`,
      CAST(`面積___` AS FLOAT64) AS `area_sqm`,
      SAFE_CAST(LEFT(`建築年`, 4) AS INT64) AS `construction_year`,
      `建物の構造` AS `building_structure`,
      `都市計画` AS `city_planning`,
      CAST(`建ぺい率___` AS FLOAT64) AS `building_coverage_ratio`,
      CAST(`容積率___` AS FLOAT64) AS `floor_area_ratio`,
      `取引時点` AS `transaction_date`
      -- DO NOT include 'total_transaction_price_log' here, as it is the column that ML.PREDICT will output.
    FROM
      `test2-465413.eveonegcp.cleaned` -- Changed to your real estate data source
    WHERE
      -- For prediction, only filter out rows where the price column (internal to the model)
      -- cannot be parsed as a number. Do NOT filter based on its value (> 0),
      -- as you want to predict prices for all valid inputs.
      SAFE_CAST(`取引価格_総額__log` AS FLOAT64) IS NOT NULL
  )
)
